<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algorithm Visualizer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        body {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        .top-panel {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            background: #f4f4f4;
            border-bottom: 2px solid #ccc;
        }
        .button {
            padding: 8px 12px;
            border: none;
            background: #007bff;
            color: white;
            cursor: pointer;
            margin-right: 5px;
        }
        .button:hover {
            background: #0056b3;
        }
        .input-box {
            padding: 5px;
            width: 80px;
        }
        .progress-bar {
            flex: 1;
            height: 20px;
            background: #ddd;
            border-radius: 10px;
            margin: 0 10px;
            position: relative;
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            background: #007bff;
            border-radius: 10px;
        }
        .layout {
            display: flex;
            flex: 1;
            height: 100%;
        }
        .accordion {
            width: 15%;
            background: #e9ecef;
            border-right: 2px solid #ccc;
            padding: 10px;
        }
        .accordion-item {
            margin-bottom: 10px;
        }
        .accordion-header {
            padding: 8px;
            background: #007bff;
            color: white;
            cursor: pointer;
            text-align: center;
        }
        .accordion-content {
            display: none;
            padding: 5px;
            background: #f4f4f4;
        }
        .accordion-content a {
            display: block;
            padding: 5px;
            text-decoration: none;
            color: black;
            cursor: pointer;
        }
        .accordion-content a:hover {
            background: #ddd;
        }
        .middle-panels {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            padding: 10px;
        }
        .panel {
            flex: 1;
            border: 2px solid #ccc;
            margin-bottom: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5em;
        }
        .right-panel {
            width: 20%;
            background: #f8f9fa;
            padding: 10px;
            border-left: 2px solid #ccc;
        }
    </style>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
        const canvas = document.getElementById('algorithmCanvas');

        // Set the canvas width and height to match its parent element's dimensions
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;

        // Get the 2D rendering context of the canvas
        const ctx = canvas.getContext('2d');

        let data = [50, 150, 100, 200, 80];
        let currentIndex = -1;
        let pivotIndex = -1;
        let swapIndices = [];

        // Initialize a flag to indicate whether sorting is in progress
        let isSorting = false;

        // Function to draw the data as bars on the canvas
        function drawData() 
        {

            // Clear Canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height); 

            const barWidth = canvas.width / data.length;
            const padding = 30;

            // Loop through the data array and draw each bar
            for (let i = 0; i < data.length; i++) {

                // Calculate the height of the bar based on the data value
                const barHeight = data[i];

                // Calculate the x and y coordinates of the bar
                const x = i * barWidth;
                const y = canvas.height - barHeight;

                // Set the fill color of the bar based on its state
                if (swapIndices.includes(i)) {
                    ctx.fillStyle = 'red';
                } else if (i === currentIndex || i === pivotIndex) {
                    ctx.fillStyle = 'blue';
                } else {
                    ctx.fillStyle = 'lightblue';
                }
                
                // Redraw each bar
                ctx.fillRect(x, y, barWidth, barHeight);
                ctx.fillStyle = 'black';
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(data[i], x + barWidth / 2, canvas.height - 10);
            }     
        }

        async function quickSort(arr, left, right) {

            // If left index is less than right index, continue sorting
            if (left < right) {

                // Get the partition index
                let partitionIndex = await partition(arr, left, right);

                // Recursively sort the left and right subarrays
                await quickSort(arr, left, partitionIndex - 1);
                await quickSort(arr, partitionIndex + 1, right);
            }
        }

        async function partition(arr, left, right) 
        {

            // Chose the rightmost element as the pivot
            let pivot = arr[right];
            pivotIndex = right;

            await delay(1000);

            let i = left - 1;

            // Loop through the array from left to right
            for (let j = left; j < right; j++) {
                currentIndex = j;
                await delay(1000);

                // If the current element is less than the pivot
                if (arr[j] < pivot) {
                    i++;
                    swapIndices = [i, j];
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                    await delay(1000);
                    appendToExplanation(`Swapped ${arr[j]} and ${arr[i]}`);
                }
                swapIndices = [];
            }
            swapIndices = [i + 1, right];
            [arr[i + 1], arr[right]] = [arr[right], arr[i + 1]];
            appendToExplanation(`Swapped ${arr[right]} and ${arr[i+1]}`);
            await delay(1000);
            currentIndex = -1;
            pivotIndex = -1;
            return i + 1;
        }

        // Function to start quicksort
        async function startQuickSort() {
            if (isSorting) return;


            // Draw the bars
            startDrawing();
            
            isSorting = true;

            // Start the quicksort algorithm
            await quickSort(data, 0, data.length - 1);
            appendToExplanation("Sorting complete!");

            // Stop drawing bars
            stopDrawing();

            isSorting = false;
        }

        function startDrawing() {
            drawInterval = setInterval(drawData, 500); 
        }

        function stopDrawing() {
            clearInterval(drawInterval);
        }

        function delay(ms) 
        {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        function appendToExplanation(text) {
            let box = document.getElementById("textExplanation");
            box.innerHTML += text + "<br>";  
            box.scrollTop = box.scrollHeight;
        }
        
        
        
        let drawInterval;
        drawData(); 
        startQuickSort();
});
  </script>

</head>
<body>

    <!-- Top Control Panel -->
    <div class="top-panel">
        <button class="button" id="randomize">Randomize</button>
        <input type="text" class="input-box" id="customInput" placeholder="Custom">
        <input type="number" class="input-box" id="listSize" placeholder="Size">
        <button class="button">&#9658;</button>
        <button class="button">||</button>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <button class="button">&#9664;</button>
        <button class="button">&#9654;</button>
    </div>

    <!-- Main Layout -->
    <div class="layout">
        <!-- Left Accordion Menu -->
        <div class="accordion">
            <div class="accordion-item">
                <div class="accordion-header">Brute Force</div>
                <div class="accordion-content">
                    <a href="#" onclick="selectAlgorithm('BFS')">BFS Algorithm</a>
                </div>
            </div>
            <div class="accordion-item">
                <div class="accordion-header">Divide and Conquer</div>
                <div class="accordion-content">
                    <a href="#" onclick="selectAlgorithm('Quicksort')">Quicksort Algorithm</a>
                </div>
            </div>
            <div class="accordion-item">
                <div class="accordion-header">Dynamic Programming</div>
                <div class="accordion-content">
                    <a href="#" onclick="selectAlgorithm('Fibonacci')">Fibonacci Algorithm</a>
                </div>
            </div>
            <div class="accordion-item">
                <div class="accordion-header">Greedy</div>
                <div class="accordion-content">
                    <a href="#" onclick="selectAlgorithm('Dijkstra')">Dijkstra's Algorithm</a>
                </div>
            </div>
        </div>

        <!-- Middle Panels -->
        <div class="middle-panels">
            <div class="panel" id="graphAnimation">
                <canvas id="algorithmCanvas"></canvas>
            </div>
            <div class="panel" id="boxListAnimation">Box-List Animation</div>
            <div class="panel" id="textExplanation"></div>
        </div>

        <!-- Right Panel -->
        <div class="right-panel" id="algorithmInfo">
            <h3>Quicksort</h3>
            <p>A divide and conquer sorting algorithm that selects a "pivot"
                element from the given array and partitions the remaining elements
                into two sub-arrays based on whether they are smaller or larger than 
                the pivot. The algorithm recursively repeats this step until the input
                is sorted.

                <br>There are mainly three steps in the algorithm:<br>

                1. <strong>Choose a Pivot</strong>: Select an element from the array as the pivot. The choice of pivot can vary (e.g., first element, last element, random element, or median).<br>
                2. <strong>Partition the Array</strong>: Rearrange the array around the pivot. After partitioning, all elements smaller than the pivot will be on its left, and all elements greater than the pivot will be on its right. The pivot is then in its correct position, and we obtain the index of the pivot.<br>
                3. <strong>Recursively Call</strong>: Recursively apply the same process to the two partitioned sub-arrays (left and right of the pivot).<br>
                4. <strong>Base Case</strong>: The recursion stops when there is only one element left in the sub-array, as a single element is already sorted.<br>
            </p>
            <h3><strong>References</strong></h3>
            <ol>
                <li id="footnote1">https://www.geeksforgeeks.org/quick-sort-algorithm/</li>
            </ol>
        </div>
    </div>

    <script>
        // Accordion Menu Functionality
        document.querySelectorAll('.accordion-header').forEach(header => {
            header.addEventListener('click', () => {
                let content = header.nextElementSibling;
                content.style.display = content.style.display === "block" ? "none" : "block";
            });
        });

        // Algorithm Selection Function
        function selectAlgorithm(name) {
            document.getElementById("algorithmInfo").innerHTML = `<h3>${name} Algorithm</h3><p>Description and pseudocode here...</p>`;
            document.getElementById("graphAnimation").textContent = `${name} Graph Animation`;
            document.getElementById("boxListAnimation").textContent = `${name} Box-List Animation`;
            document.getElementById("textExplanation").textContent = `${name} explanation here...`;
        }
    </script>

</body>
</html>
